---
title: À l’aide de migrate.exe - EF6
author: divega
ms.date: 2016-10-23
ms.assetid: 989ea862-e936-4c85-926a-8cfbef5df5b8
ms.openlocfilehash: 8f0ff6d472c39eaf000c31783fe7a769c8746fec
ms.sourcegitcommit: 0d36e8ff0892b7f034b765b15e041f375f88579a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/09/2018
ms.locfileid: "44251113"
---
# <a name="using-migrateexe"></a><span data-ttu-id="d884f-102">À l’aide de migrate.exe</span><span class="sxs-lookup"><span data-stu-id="d884f-102">Using migrate.exe</span></span>
<span data-ttu-id="d884f-103">Migrations Code First peut être utilisées pour mettre à jour une base de données à l’intérieur de visual studio, mais peuvent également être exécutées via la migrate.exe outil ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="d884f-103">Code First Migrations can be used to update a database from inside visual studio, but can also be executed via the command line tool migrate.exe.</span></span> <span data-ttu-id="d884f-104">Cette page pour obtenir une vue d’ensemble rapide sur comment utiliser migrate.exe pour exécuter des migrations par rapport à une base de données.</span><span class="sxs-lookup"><span data-stu-id="d884f-104">This page will give a quick overview on how to use migrate.exe to execute migrations against a database.</span></span>

> [!NOTE]
> <span data-ttu-id="d884f-105">Cet article suppose que vous savez comment utiliser Code First Migrations dans des scénarios de base.</span><span class="sxs-lookup"><span data-stu-id="d884f-105">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="d884f-106">Si vous n’avez pas, vous devez lire [Migrations Code First](~/ef6/modeling/code-first/migrations/index.md) avant de continuer.</span><span class="sxs-lookup"><span data-stu-id="d884f-106">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="copy-migrateexe"></a><span data-ttu-id="d884f-107">Copie migrate.exe</span><span class="sxs-lookup"><span data-stu-id="d884f-107">Copy migrate.exe</span></span>

<span data-ttu-id="d884f-108">Lorsque vous installez Entity Framework à l’aide de NuGet migrate.exe se trouve dans le dossier des outils du package téléchargé.</span><span class="sxs-lookup"><span data-stu-id="d884f-108">When you install Entity Framework using NuGet migrate.exe will be inside the tools folder of the downloaded package.</span></span> <span data-ttu-id="d884f-109">Dans &lt;dossier du projet&gt;\\packages\\EntityFramework.&lt; version&gt;\\outils</span><span class="sxs-lookup"><span data-stu-id="d884f-109">In &lt;project folder&gt;\\packages\\EntityFramework.&lt;version&gt;\\tools</span></span>

<span data-ttu-id="d884f-110">Une fois que vous avez migrate.exe vous devez copier dans l’emplacement de l’assembly qui contient vos migrations.</span><span class="sxs-lookup"><span data-stu-id="d884f-110">Once you have migrate.exe then you need to copy it to the location of the assembly that contains your migrations.</span></span>

<span data-ttu-id="d884f-111">Si votre application cible le .NET 4 et 4.5 pas, puis vous devrez copier le **Redirect.config** dans l’emplacement ainsi et renommez-le **migrate.exe.config**. Il s’agit donc que migrate.exe obtient les redirections de liaison correct pour être en mesure de localiser l’assembly d’Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="d884f-111">If your application targets .NET 4, and not 4.5, then you will need to copy the **Redirect.config** into the location as well and rename it **migrate.exe.config**. This is so that migrate.exe gets the correct binding redirects to be able to locate the Entity Framework assembly.</span></span>

| <span data-ttu-id="d884f-112">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="d884f-112">.NET 4.5</span></span>                                   | <span data-ttu-id="d884f-113">.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="d884f-113">.NET 4.0</span></span>                                   |
|:-------------------------------------------|:-------------------------------------------|
| ![Fichiers de .NET 4.5](~/ef6/media/net45files.png)  | ![Fichiers de .NET 4.0](~/ef6/media/net40files.png)  |

> [!NOTE]
> <span data-ttu-id="d884f-116">Migrate.exe ne prend pas en charge x64 assemblys.</span><span class="sxs-lookup"><span data-stu-id="d884f-116">migrate.exe doesn't support x64 assemblies.</span></span>

<span data-ttu-id="d884f-117">Une fois que vous avez déplacé migrate.exe dans le dossier approprié, vous devez être en mesure d’utiliser pour exécuter des migrations par rapport à la base de données.</span><span class="sxs-lookup"><span data-stu-id="d884f-117">Once you have moved migrate.exe to the correct folder then you should be able to use it to execute migrations against the database.</span></span> <span data-ttu-id="d884f-118">L’utilitaire est conçu pour faire il suffit exécuter des migrations.</span><span class="sxs-lookup"><span data-stu-id="d884f-118">All the utility is designed to do is execute migrations.</span></span> <span data-ttu-id="d884f-119">Il ne peut pas générer des migrations ou créer un script SQL.</span><span class="sxs-lookup"><span data-stu-id="d884f-119">It cannot generate migrations or create a SQL script.</span></span>

## <a name="see-options"></a><span data-ttu-id="d884f-120">Consultez les options</span><span class="sxs-lookup"><span data-stu-id="d884f-120">See options</span></span>

``` console
Migrate.exe /?
```

<span data-ttu-id="d884f-121">La méthode ci-dessus affiche la page d’aide associée à cet utilitaire, notez que vous devez avoir l’EntityFramework.dll dans le même emplacement que vous exécutez migrate.exe pour que cela fonctionne.</span><span class="sxs-lookup"><span data-stu-id="d884f-121">The above will display the help page associated with this utility, note that you will need to have the EntityFramework.dll in the same location that you are running migrate.exe in order for this to work.</span></span>

## <a name="migrate-to-the-latest-migration"></a><span data-ttu-id="d884f-122">Migrer vers la dernière migration</span><span class="sxs-lookup"><span data-stu-id="d884f-122">Migrate to the latest migration</span></span>

``` console
Migrate.exe MyMvcApplication.dll /startupConfigurationFile=”..\\web.config”
```

<span data-ttu-id="d884f-123">Lorsque migrate.exe en cours d’exécution le paramètre obligatoire uniquement est l’assembly, qui est l’assembly qui contient les migrations que vous tentez d’exécuter, mais il utilise une convention tous les paramètres basés sur si vous ne spécifiez pas le fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="d884f-123">When running migrate.exe the only mandatory parameter is the assembly, which is the assembly that contains the migrations that you are trying to run, but it will use all convention based settings if you do not specify the configuration file.</span></span>

## <a name="migrate-to-a-specific-migration"></a><span data-ttu-id="d884f-124">Migrer vers une migration spécifique</span><span class="sxs-lookup"><span data-stu-id="d884f-124">Migrate to a specific migration</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile=”MyApp.exe.config” /targetMigration=”AddTitle”
```

<span data-ttu-id="d884f-125">Si vous souhaitez exécuter des migrations jusqu'à une migration spécifique, vous pouvez spécifier le nom de la migration.</span><span class="sxs-lookup"><span data-stu-id="d884f-125">If you want to run migrations up to a specific migration, then you can specify the name of the migration.</span></span> <span data-ttu-id="d884f-126">Cela exécutera toutes les migrations précédentes en fonction des besoins jusqu'à ce que la mise à la migration spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d884f-126">This will run all previous migrations as required until getting to the migration specified.</span></span>

## <a name="specify-working-directory"></a><span data-ttu-id="d884f-127">Spécifiez le répertoire de travail</span><span class="sxs-lookup"><span data-stu-id="d884f-127">Specify working directory</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile=”MyApp.exe.config” /startupDirectory=”c:\\MyApp”
```

<span data-ttu-id="d884f-128">Si vous assembly possède des dépendances ou lit les fichiers par rapport au répertoire de travail vous devrez définir startupDirectory.</span><span class="sxs-lookup"><span data-stu-id="d884f-128">If you assembly has dependencies or reads files relative to the working directory then you will need to set startupDirectory.</span></span>

## <a name="specify-migration-configuration-to-use"></a><span data-ttu-id="d884f-129">Spécifier la configuration de la migration à utiliser</span><span class="sxs-lookup"><span data-stu-id="d884f-129">Specify migration configuration to use</span></span>

``` console
Migrate.exe MyAssembly CustomConfig /startupConfigurationFile=”..\\web.config”
```

<span data-ttu-id="d884f-130">Si vous avez plusieurs classes de configuration de migration, classes qui héritent de DbMigrationConfiguration, puis vous devez spécifier ce qui doit être utilisé pour cette exécution.</span><span class="sxs-lookup"><span data-stu-id="d884f-130">If you have multiple migration configuration classes, classes inheriting from DbMigrationConfiguration, then you need to specify which is to be used for this execution.</span></span> <span data-ttu-id="d884f-131">Cela est spécifié en fournissant le deuxième paramètre facultatif sans commutateur comme ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="d884f-131">This is specified by providing the optional second parameter without a switch as above.</span></span>

## <a name="provide-connection-string"></a><span data-ttu-id="d884f-132">Fournir la chaîne de connexion</span><span class="sxs-lookup"><span data-stu-id="d884f-132">Provide connection string</span></span>

``` console
Migrate.exe BlogDemo.dll /connectionString=”Data Source=localhost;Initial Catalog=BlogDemo;Integrated Security=SSPI” /connectionProviderName=”System.Data.SqlClient”
```

<span data-ttu-id="d884f-133">Si vous souhaitez spécifier une chaîne de connexion à la ligne de commande, vous devez également fournir le nom du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d884f-133">If you wish to specify a connection string at the command line then you must also provide the provider name.</span></span> <span data-ttu-id="d884f-134">Ne pas spécifier le nom du fournisseur provoquera une exception.</span><span class="sxs-lookup"><span data-stu-id="d884f-134">Not specifying the provider name will cause an exception.</span></span>

## <a name="common-problems"></a><span data-ttu-id="d884f-135">Problèmes courants</span><span class="sxs-lookup"><span data-stu-id="d884f-135">Common Problems</span></span>

| <span data-ttu-id="d884f-136">Message d'erreur</span><span class="sxs-lookup"><span data-stu-id="d884f-136">Error Message</span></span>                                                                                                                                                                                                                                                                                                                      | <span data-ttu-id="d884f-137">Solution</span><span class="sxs-lookup"><span data-stu-id="d884f-137">Solution</span></span>                                                                                                                                                                                                                                                                                             |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d884f-138">Exception non gérée : System.IO.FileLoadException : Impossible de charger le fichier ou l’assembly ' Entity Framework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089' ou une de ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="d884f-138">Unhandled Exception: System.IO.FileLoadException:  Could not load file or assembly 'EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="d884f-139">Définition du manifeste de l’assembly trouvée ne correspond pas à la référence d’assembly.</span><span class="sxs-lookup"><span data-stu-id="d884f-139">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="d884f-140">(Exception de HRESULT : 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="d884f-140">(Exception from HRESULT: 0x80131040)</span></span>         | <span data-ttu-id="d884f-141">Cela signifie généralement que vous exécutez une application .NET 4 sans le fichier Redirect.config.</span><span class="sxs-lookup"><span data-stu-id="d884f-141">This typically means that you are running a .NET 4 application without the Redirect.config file.</span></span> <span data-ttu-id="d884f-142">Vous devez copier le Redirect.config au même emplacement que migrate.exe et renommez-le migrate.exe.config.</span><span class="sxs-lookup"><span data-stu-id="d884f-142">You need to copy the Redirect.config to the same location as migrate.exe and rename it to migrate.exe.config.</span></span>                                                                                       |
| <span data-ttu-id="d884f-143">Exception non gérée : System.IO.FileLoadException : Impossible de charger le fichier ou l’assembly ' Entity Framework, Version = 4.4.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089' ou une de ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="d884f-143">Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="d884f-144">Définition du manifeste de l’assembly trouvée ne correspond pas à la référence d’assembly.</span><span class="sxs-lookup"><span data-stu-id="d884f-144">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="d884f-145">(Exception de HRESULT : 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="d884f-145">(Exception from HRESULT: 0x80131040)</span></span>          | <span data-ttu-id="d884f-146">Cette exception signifie que vous exécutez une application avec le Redirect.config copiée à l’emplacement migrate.exe de .NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="d884f-146">This exception means that you are running a .NET 4.5 application with the Redirect.config copied to the migrate.exe location.</span></span> <span data-ttu-id="d884f-147">Si votre application est .NET 4.5 il est inutile d’avoir le fichier de configuration avec la redirection à l’intérieur.</span><span class="sxs-lookup"><span data-stu-id="d884f-147">If your app is .NET 4.5 then you do not need to have the config file with the redirects inside.</span></span> <span data-ttu-id="d884f-148">Supprimez le fichier migrate.exe.config.</span><span class="sxs-lookup"><span data-stu-id="d884f-148">Delete the migrate.exe.config file.</span></span>                                    |
| <span data-ttu-id="d884f-149">Erreur : Impossible de mettre à jour de la base de données pour faire correspondre le modèle actuel, car les modifications en attente et la migration automatique est désactivée.</span><span class="sxs-lookup"><span data-stu-id="d884f-149">ERROR: Unable to update database to match the current model because there are pending changes and automatic migration is disabled.</span></span> <span data-ttu-id="d884f-150">Écrire les modifications de modèle en attente dans une migration basée sur le code ou activez la migration automatique.</span><span class="sxs-lookup"><span data-stu-id="d884f-150">Either write the pending model changes to a code-based migration or enable automatic migration.</span></span> <span data-ttu-id="d884f-151">Définissez DbMigrationsConfiguration.AutomaticMigrationsEnabled à True pour activer la migration automatique.</span><span class="sxs-lookup"><span data-stu-id="d884f-151">Set DbMigrationsConfiguration.AutomaticMigrationsEnabled to true to enable automatic migration.</span></span> | <span data-ttu-id="d884f-152">Cette erreur se produit si effectuez la migration en cours d’exécution lorsque vous n’avez pas créé une migration pour prendre en charge les modifications apportées au modèle et la base de données ne correspond pas au modèle.</span><span class="sxs-lookup"><span data-stu-id="d884f-152">This error occurs if running migrate when you haven’t created a migration to cope with changes made to the model, and the database does not match the model.</span></span> <span data-ttu-id="d884f-153">Ajout d’une propriété à une classe de modèle puis en exécutant migrate.exe sans provoquer la création d’une migration pour mettre à niveau la base de données est un exemple.</span><span class="sxs-lookup"><span data-stu-id="d884f-153">Adding a property to a model class then running migrate.exe without creating a migration to upgrade the database is an example of this.</span></span> |
| <span data-ttu-id="d884f-154">Erreur : Le Type n’est pas résolu pour le membre ' System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 ».</span><span class="sxs-lookup"><span data-stu-id="d884f-154">ERROR: Type is not resolved for member 'System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</span></span>                                                                                                                                       | <span data-ttu-id="d884f-155">Cette erreur peut résulter en spécifiant un répertoire de démarrage incorrects.</span><span class="sxs-lookup"><span data-stu-id="d884f-155">This error can be caused by specifying an incorrect startup directory.</span></span> <span data-ttu-id="d884f-156">Cela doit être l’emplacement de migrate.exe</span><span class="sxs-lookup"><span data-stu-id="d884f-156">This must be the location of migrate.exe</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="d884f-157">Exception non gérée : System.NullReferenceException : référence non définie sur une instance d’un objet de l’objet.</span><span class="sxs-lookup"><span data-stu-id="d884f-157">Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.</span></span> <br/>   <span data-ttu-id="d884f-158">à System.Data.Entity.Migrations.Console.Program.Main (String [] args)</span><span class="sxs-lookup"><span data-stu-id="d884f-158">at System.Data.Entity.Migrations.Console.Program.Main(String[] args)</span></span>                                                                                                                                             | <span data-ttu-id="d884f-159">Cela peut être dû à ne pas spécifier un paramètre obligatoire pour un scénario que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="d884f-159">This can be caused by not specifying a required parameter for a scenario that you are using.</span></span> <span data-ttu-id="d884f-160">Par exemple, en spécifiant une chaîne de connexion sans spécifier le nom du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d884f-160">For example specifying a connection string without specifying the provider name.</span></span>                                                                                                                        |
| <span data-ttu-id="d884f-161">Erreur : plusieurs types de configuration de migrations a été trouvée dans l’assembly « ClassLibrary1 ».</span><span class="sxs-lookup"><span data-stu-id="d884f-161">ERROR: More than one migrations configuration type was found in the assembly 'ClassLibrary1'.</span></span> <span data-ttu-id="d884f-162">Spécifiez le nom de l’objet à utiliser.</span><span class="sxs-lookup"><span data-stu-id="d884f-162">Specify the name of the one to use.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="d884f-163">Comme l’erreur indique, il existe plusieurs configuration classe dans l’assembly donné.</span><span class="sxs-lookup"><span data-stu-id="d884f-163">As the error states, there is more than one configuration class in the given assembly.</span></span> <span data-ttu-id="d884f-164">Vous devez utiliser le commutateur /configurationType pour spécifier lequel utiliser.</span><span class="sxs-lookup"><span data-stu-id="d884f-164">You must use the /configurationType switch to specify which to use.</span></span>                                                                                                                                           |
| <span data-ttu-id="d884f-165">Erreur : Impossible de charger un fichier ou assembly '&lt;assemblyName&gt;' ou une de ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="d884f-165">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;’ or one of its dependencies.</span></span> <span data-ttu-id="d884f-166">L’assembly donné codebase ou de nom n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="d884f-166">The given assembly name or codebase was invalid.</span></span> <span data-ttu-id="d884f-167">(Exception de HRESULT : 0x80131047)</span><span class="sxs-lookup"><span data-stu-id="d884f-167">(Exception from HRESULT: 0x80131047)</span></span>                                                                                                                                                    | <span data-ttu-id="d884f-168">Cela peut être dû en spécifiant un nom d’assembly incorrecte ou n’ayant ne pas</span><span class="sxs-lookup"><span data-stu-id="d884f-168">This can be caused by specifying an assembly name incorrectly or not having</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="d884f-169">Erreur : Impossible de charger un fichier ou assembly '&lt;assemblyName&gt;' ou une de ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="d884f-169">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;' or one of its dependencies.</span></span> <span data-ttu-id="d884f-170">Tentative de chargement d’un programme au format incorrect.</span><span class="sxs-lookup"><span data-stu-id="d884f-170">An attempt was made to load a program with an incorrect format.</span></span>                                                                                                                                                                          | <span data-ttu-id="d884f-171">Cela se produit si vous essayez d’exécuter migrate.exe contre un x64 application.</span><span class="sxs-lookup"><span data-stu-id="d884f-171">This happens if you are trying to run migrate.exe against an x64 application.</span></span> <span data-ttu-id="d884f-172">Entity Framework 5.0 et ci-dessous ne fonctionnent que pour x86.</span><span class="sxs-lookup"><span data-stu-id="d884f-172">EF 5.0 and below will only work on x86.</span></span>                                                                                                                                                                                |
