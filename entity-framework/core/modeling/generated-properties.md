---
title: Valeurs générées - EF Core
author: rowanmiller
ms.date: 10/27/2016
ms.assetid: eb082011-11a1-41b4-a108-15daafa03e80
uid: core/modeling/generated-properties
ms.openlocfilehash: a3656eb1d2dc79ceead04e3a142a58e8afb3cbce
ms.sourcegitcommit: dadee5905ada9ecdbae28363a682950383ce3e10
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/27/2018
ms.locfileid: "42996775"
---
# <a name="generated-values"></a><span data-ttu-id="fa8e5-102">Valeurs générées</span><span class="sxs-lookup"><span data-stu-id="fa8e5-102">Generated Values</span></span>

## <a name="value-generation-patterns"></a><span data-ttu-id="fa8e5-103">Modèles de génération de valeur</span><span class="sxs-lookup"><span data-stu-id="fa8e5-103">Value Generation Patterns</span></span>

<span data-ttu-id="fa8e5-104">Il existe trois modèles de génération de valeur qui peuvent être utilisées pour les propriétés.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-104">There are three value generation patterns that can be used for properties.</span></span>

### <a name="no-value-generation"></a><span data-ttu-id="fa8e5-105">Aucune génération de valeur</span><span class="sxs-lookup"><span data-stu-id="fa8e5-105">No value generation</span></span>

<span data-ttu-id="fa8e5-106">Aucune génération de valeur ne signifie que vous fournirez toujours une valeur valide pour être enregistrés dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-106">No value generation means that you will always supply a valid value to be saved to the database.</span></span> <span data-ttu-id="fa8e5-107">Cette valeur valide doit être affectée aux nouvelles entités avant d’être ajoutés au contexte.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-107">This valid value must be assigned to new entities before they are added to the context.</span></span>

### <a name="value-generated-on-add"></a><span data-ttu-id="fa8e5-108">Valeur générée sur Ajouter</span><span class="sxs-lookup"><span data-stu-id="fa8e5-108">Value generated on add</span></span>

<span data-ttu-id="fa8e5-109">Valeur générée sur Ajouter signifie une valeur générée pour les nouvelles entités.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-109">Value generated on add means that a value is generated for new entities.</span></span>

<span data-ttu-id="fa8e5-110">Selon le fournisseur de base de données utilisé, les valeurs peuvent être générées côté client par Entity Framework ou dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-110">Depending on the database provider being used, values may be generated client side by EF or in the database.</span></span> <span data-ttu-id="fa8e5-111">Si la valeur est générée par la base de données, EF peut affecter une valeur temporaire lorsque vous ajoutez l’entité au contexte.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-111">If the value is generated by the database, then EF may assign a temporary value when you add the entity to the context.</span></span> <span data-ttu-id="fa8e5-112">Cette valeur temporaire est alors remplacée par la valeur de la base de données générée au cours de `SaveChanges()`.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-112">This temporary value will then be replaced by the database generated value during `SaveChanges()`.</span></span>

<span data-ttu-id="fa8e5-113">Si vous ajoutez une entité au contexte qui a la valeur affectée à la propriété, puis EF tente insérer cette valeur au lieu de générer un nouveau.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-113">If you add an entity to the context that has a value assigned to the property, then EF will attempt to insert that value rather than generating a new one.</span></span> <span data-ttu-id="fa8e5-114">Une propriété est considérée comme ayant une valeur affectée s’il n’est pas affecté la valeur par défaut CLR (`null` pour `string`, `0` pour `int`, `Guid.Empty` pour `Guid`, etc..).</span><span class="sxs-lookup"><span data-stu-id="fa8e5-114">A property is considered to have a value assigned if it is not assigned the CLR default value (`null` for `string`, `0` for `int`, `Guid.Empty` for `Guid`, etc.).</span></span> <span data-ttu-id="fa8e5-115">Pour plus d’informations, consultez [explicitement les valeurs des propriétés générées](../saving/explicit-values-generated-properties.md).</span><span class="sxs-lookup"><span data-stu-id="fa8e5-115">For more information, see [Explicit values for generated properties](../saving/explicit-values-generated-properties.md).</span></span>

> [!WARNING]  
> <span data-ttu-id="fa8e5-116">Comment la valeur est générée pour les entités ajoutées dépendent du fournisseur de base de données utilisé.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-116">How the value is generated for added entities will depend on the database provider being used.</span></span> <span data-ttu-id="fa8e5-117">Fournisseurs de base de données peuvent configurer automatiquement la génération de valeur pour certains types de propriété, mais d’autres peuvent nécessiter vous permettent de configurer manuellement la façon dont la valeur est générée.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-117">Database providers may automatically setup value generation for some property types, but others may require you to manually setup how the value is generated.</span></span>
>
> <span data-ttu-id="fa8e5-118">Par exemple, lorsque vous utilisez SQL Server, les valeurs seront être générées automatiquement pour `GUID` propriétés (à l’aide de l’algorithme GUID séquentiel de SQL Server).</span><span class="sxs-lookup"><span data-stu-id="fa8e5-118">For example, when using SQL Server, values will be automatically generated for `GUID` properties (using the SQL Server sequential GUID algorithm).</span></span> <span data-ttu-id="fa8e5-119">Toutefois, si vous indiquez qu’un `DateTime` propriété est générée lors de l’ajout, puis vous devez configurer un moyen pour les valeurs à être généré.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-119">However, if you specify that a `DateTime` property is generated on add, then you must setup a way for the values to be generated.</span></span> <span data-ttu-id="fa8e5-120">Pour faire cela, consiste à configurer une valeur par défaut de `GETDATE()`, consultez [valeurs par défaut](relational/default-values.md).</span><span class="sxs-lookup"><span data-stu-id="fa8e5-120">One way to do this, is to configure a default value of `GETDATE()`, see [Default Values](relational/default-values.md).</span></span>

### <a name="value-generated-on-add-or-update"></a><span data-ttu-id="fa8e5-121">Valeur générée dans Ajouter ou mettre à jour</span><span class="sxs-lookup"><span data-stu-id="fa8e5-121">Value generated on add or update</span></span>

<span data-ttu-id="fa8e5-122">Valeur générée lors de l’ajout ou la mise à jour signifie qu’une nouvelle valeur est générée chaque fois que l’enregistrement (insert ou update).</span><span class="sxs-lookup"><span data-stu-id="fa8e5-122">Value generated on add or update means that a new value is generated every time the record is saved (insert or update).</span></span>

<span data-ttu-id="fa8e5-123">Comme `value generated on add`, si vous spécifiez une valeur pour la propriété sur une instance nouvellement ajoutée d’une entité, que la valeur sera insérée plutôt qu’une valeur en cours de génération.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-123">Like `value generated on add`, if you specify a value for the property on a newly added instance of an entity, that value will be inserted rather than a value being generated.</span></span> <span data-ttu-id="fa8e5-124">Il est également possible de définir une valeur explicite lors de la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-124">It is also possible to set an explicit value when updating.</span></span> <span data-ttu-id="fa8e5-125">Pour plus d’informations, consultez [explicitement les valeurs des propriétés générées](../saving/explicit-values-generated-properties.md).</span><span class="sxs-lookup"><span data-stu-id="fa8e5-125">For more information, see [Explicit values for generated properties](../saving/explicit-values-generated-properties.md).</span></span>

> [!WARNING]
> <span data-ttu-id="fa8e5-126">Comment la valeur est générée pour les entités ajoutées et mis à jour dépend du fournisseur de base de données utilisé.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-126">How the value is generated for added and updated entities will depend on the database provider being used.</span></span> <span data-ttu-id="fa8e5-127">Fournisseurs de base de données peuvent configurer automatiquement la génération de valeur pour certains types de propriété, tandis que d’autres nécessiteront vous permettent de configurer manuellement la façon dont la valeur est générée.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-127">Database providers may automatically setup value generation for some property types, while others will require you to manually setup how the value is generated.</span></span>
> 
> <span data-ttu-id="fa8e5-128">Par exemple, lors de l’utilisation de SQL Server, `byte[]` propriétés qui sont définies comme générées sur Ajouter ou mettre à jour et les jetons d’accès concurrentiel, la mention sera configuré avec le `rowversion` de type de données - afin que les valeurs dans la base de données va être générés.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-128">For example, when using SQL Server, `byte[]` properties that are set as generated on add or update and marked as concurrency tokens, will be setup with the `rowversion` data type - so that values will be generated in the database.</span></span> <span data-ttu-id="fa8e5-129">Toutefois, si vous indiquez qu’un `DateTime` propriété est générée sous Ajouter ou mettre à jour, puis vous devez configurer un moyen pour les valeurs à être généré.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-129">However, if you specify that a `DateTime` property is generated on add or update, then you must setup a way for the values to be generated.</span></span> <span data-ttu-id="fa8e5-130">Pour faire cela, consiste à configurer une valeur par défaut de `GETDATE()` (consultez [valeurs par défaut](relational/default-values.md)) pour générer des valeurs pour les nouvelles lignes.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-130">One way to do this, is to configure a default value of `GETDATE()` (see [Default Values](relational/default-values.md)) to generate values for new rows.</span></span> <span data-ttu-id="fa8e5-131">Vous pouvez ensuite utiliser un déclencheur de base de données pour générer des valeurs pendant les mises à jour (par exemple, le déclencheur suivant de l’exemple).</span><span class="sxs-lookup"><span data-stu-id="fa8e5-131">You could then use a database trigger to generate values during updates (such as the following example trigger).</span></span>
> 
> [!code-sql[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedOnAddOrUpdate.sql)]

## <a name="conventions"></a><span data-ttu-id="fa8e5-132">Conventions</span><span class="sxs-lookup"><span data-stu-id="fa8e5-132">Conventions</span></span>

<span data-ttu-id="fa8e5-133">Par convention, non composites des clés primaires de type short, int, long ou Guid sera configuré pour avoir des valeurs générées sur Ajouter.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-133">By convention, non-composite primary keys of type short, int, long, or Guid will be setup to have values generated on add.</span></span> <span data-ttu-id="fa8e5-134">Toutes les autres propriétés sera configuré avec aucune génération de valeur.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-134">All other properties will be setup with no value generation.</span></span>

## <a name="data-annotations"></a><span data-ttu-id="fa8e5-135">Annotations de données</span><span class="sxs-lookup"><span data-stu-id="fa8e5-135">Data Annotations</span></span>

### <a name="no-value-generation-data-annotations"></a><span data-ttu-id="fa8e5-136">Aucune génération de valeur (Annotations de données)</span><span class="sxs-lookup"><span data-stu-id="fa8e5-136">No value generation (Data Annotations)</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/Samples/ValueGeneratedNever.cs#Sample)]

### <a name="value-generated-on-add-data-annotations"></a><span data-ttu-id="fa8e5-137">Valeur générée sur Ajouter (Annotations de données)</span><span class="sxs-lookup"><span data-stu-id="fa8e5-137">Value generated on add (Data Annotations)</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/Samples/ValueGeneratedOnAdd.cs#Sample)]

> [!WARNING]  
> <span data-ttu-id="fa8e5-138">Cela permet simplement EF de savoir que les valeurs sont générées pour les entités ajoutées, cela ne garantit pas que EF vous permettront de configurer le mécanisme pour générer des valeurs.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-138">This just lets EF know that values are generated for added entities, it does not guarantee that EF will setup the actual mechanism to generate values.</span></span> <span data-ttu-id="fa8e5-139">Consultez [ajouter de la valeur générée sur](#value-generated-on-add) section pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-139">See [Value generated on add](#value-generated-on-add) section for more details.</span></span>

### <a name="value-generated-on-add-or-update-data-annotations"></a><span data-ttu-id="fa8e5-140">Valeur générée sur Ajouter ou mettre à jour (Annotations de données)</span><span class="sxs-lookup"><span data-stu-id="fa8e5-140">Value generated on add or update (Data Annotations)</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/Samples/ValueGeneratedOnAddOrUpdate.cs#Sample)]

> [!WARNING]  
> <span data-ttu-id="fa8e5-141">Cela permet simplement EF de savoir que les valeurs sont générées pour les entités ajoutées ou mises à jour, il ne garantit pas que EF vous permettront de configurer le mécanisme pour générer des valeurs.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-141">This just lets EF know that values are generated for added or updated entities, it does not guarantee that EF will setup the actual mechanism to generate values.</span></span> <span data-ttu-id="fa8e5-142">Consultez [valeur générée sur Ajouter ou mettre à jour](#value-generated-on-add-or-update) section pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-142">See [Value generated on add or update](#value-generated-on-add-or-update) section for more details.</span></span>

## <a name="fluent-api"></a><span data-ttu-id="fa8e5-143">API Fluent</span><span class="sxs-lookup"><span data-stu-id="fa8e5-143">Fluent API</span></span>

<span data-ttu-id="fa8e5-144">Vous pouvez utiliser l’API Fluent à modifier le modèle de génération de valeur pour une propriété donnée.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-144">You can use the Fluent API to change the value generation pattern for a given property.</span></span>

### <a name="no-value-generation-fluent-api"></a><span data-ttu-id="fa8e5-145">Aucune génération de valeur (API Fluent)</span><span class="sxs-lookup"><span data-stu-id="fa8e5-145">No value generation (Fluent API)</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedNever.cs#Sample)]

### <a name="value-generated-on-add-fluent-api"></a><span data-ttu-id="fa8e5-146">Valeur générée sur Ajouter (API Fluent)</span><span class="sxs-lookup"><span data-stu-id="fa8e5-146">Value generated on add (Fluent API)</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedOnAdd.cs#Sample)]

> [!WARNING]  
> <span data-ttu-id="fa8e5-147">`ValueGeneratedOnAdd()` Venez informe Entity Framework que les valeurs sont générées pour les entités ajoutées, cela ne garantit pas que EF vous permettront de configurer le mécanisme pour générer des valeurs.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-147">`ValueGeneratedOnAdd()` just lets EF know that values are generated for added entities, it does not guarantee that EF will setup the actual mechanism to generate values.</span></span>  <span data-ttu-id="fa8e5-148">Consultez [ajouter de la valeur générée sur](#value-generated-on-add) section pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-148">See [Value generated on add](#value-generated-on-add) section for more details.</span></span>

### <a name="value-generated-on-add-or-update-fluent-api"></a><span data-ttu-id="fa8e5-149">Valeur générée sur Ajouter ou mettre à jour (API Fluent)</span><span class="sxs-lookup"><span data-stu-id="fa8e5-149">Value generated on add or update (Fluent API)</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedOnAddOrUpdate.cs#Sample)]

> [!WARNING]  
> <span data-ttu-id="fa8e5-150">Cela permet simplement EF de savoir que les valeurs sont générées pour les entités ajoutées ou mises à jour, il ne garantit pas que EF vous permettront de configurer le mécanisme pour générer des valeurs.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-150">This just lets EF know that values are generated for added or updated entities, it does not guarantee that EF will setup the actual mechanism to generate values.</span></span> <span data-ttu-id="fa8e5-151">Consultez [valeur générée sur Ajouter ou mettre à jour](#value-generated-on-add-or-update) section pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="fa8e5-151">See [Value generated on add or update](#value-generated-on-add-or-update) section for more details.</span></span>
